<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.8">
<meta name="keywords" content="Business Banking Widget Collection, BACKBASE, services">
<title>Field mapping</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<style>.toc-current{font-weight: bold;} .toc-root{font-family: "Open Sans","DejaVu Sans",sans-serif;
                         font-size: 0.9em;} #content{display: flex; flex-direction: column; flex: 1 1 auto;}
               .nav-footer{text-align: center; margin-top: auto;}
               .nav-footer > p > a {white-space: nowrap;}</style>
</head>
<body id="field_mapping" class="book toc2 toc-left">
<div id="header">
<h1>Field mapping</h1>
<div class="details">
<span id="revnumber">version 3.10.1</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<p><span class="toc-root toc-current"><a href="index.html">Business Banking Widget Collection</a></span></p><ul class="sectlevel1">
<li><a href="understand.html">Understand  Business Banking Widget Collection v3.10.1</a>
<ul class="sectlevel2">
<li><a href="what_are_widget_collections.html">What is Business Banking Widget Collection</a>
</li>
<li><a href="accountstatements_understand.html">Understand Account Statements</a>
<ul class="sectlevel3">
<li><a href="web_account_statements.html">Web widgets</a>
</li>
</ul>
</li>
<li><a href="authentication_understand.html">Understand Authentication</a>
<ul class="sectlevel3">
<li><a href="web_authentication.html">Web widgets</a>
</li>
</ul>
</li>
<li><a href="batches_understand.html">Understand Batches</a>
<ul class="sectlevel3">
<li><a href="web_batches.html">Web widgets</a>
</li>
</ul>
</li>
<li><a href="cardmanagement_understand.html">Understand Card Management</a>
<ul class="sectlevel3">
<li><a href="web_card_management.html">Web widgets</a>
</li>
</ul>
</li>
<li><a href="cashflowforecasting_understand.html">Understand Cash Flow Forecasting</a>
<ul class="sectlevel3">
<li><a href="web_cash_flow_forecasting.html">Web widgets</a>
</li>
</ul>
</li>
<li><a href="contacts_understand.html">Understand Contacts</a>
<ul class="sectlevel3">
<li><a href="web_contacts.html">Web widgets</a>
</li>
</ul>
</li>
<li><a href="fx_trading_understand.html">Understand FX Trading</a>
<ul class="sectlevel3">
<li><a href="web_fx_trading.html">Web widgets</a>
</li>
</ul>
</li>
<li><a href="messages_understand.html">Understand Messages</a>
<ul class="sectlevel3">
<li><a href="web_messages.html">Web widgets</a>
</li>
</ul>
</li>
<li><a href="notifications_understand.html">Understand Notifications</a>
<ul class="sectlevel3">
<li><a href="web_notifications.html">Web widgets</a>
</li>
</ul>
</li>
<li><a href="payments_understand.html">Understand Payments</a>
<ul class="sectlevel3">
<li><a href="web_payments.html">Web widgets</a>
</li>
</ul>
</li>
<li><a href="places_understand.html">Understand Places</a>
<ul class="sectlevel3">
<li><a href="web_places.html">Web widgets</a>
</li>
</ul>
</li>
<li><a href="product_summary_understand.html">Understand Products</a>
<ul class="sectlevel3">
<li><a href="web_products.html">Web widgets</a>
</li>
</ul>
</li>
<li><a href="sweeping_understand.html">Understand Sweeping</a>
<ul class="sectlevel3">
<li><a href="web_sweeping.html">Web widgets</a>
</li>
</ul>
</li>
<li><a href="transaction_list_understand.html">Understand Transactions</a>
<ul class="sectlevel3">
<li><a href="web_transactions.html">Web widgets</a>
</li>
</ul>
</li>
<li><a href="user_self_service.html">Understand User Self Service</a>
<ul class="sectlevel3">
<li><a href="web_user_management.html">Web widgets</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="install_and_configure.html">Install</a>
<ul class="sectlevel2">
<li><a href="install_the_widget_collection_3_demo.html">Deploy the demo app for web</a>
</li>
<li><a href="install_the_lean_page_template.html">Install the lean page template for Widget Collection 3</a>
</li>
<li><a href="setup_widget_development_environment.html">Set up a widget development environment</a>
</li>
</ul>
</li>
<li><a href="use.html">Adopt</a>
<ul class="sectlevel2">
<li><a href="adopt_omni_payment_widget.html">Adopt the Initiate omni payment widget</a>
</li>
<li><a href="configure_create_payment_template_widget.html">Configure the Create payment template widget</a>
</li>
<li><a href="adopt_payment_wizard_widget.html">Adopt the Payment Wizard widget</a>
</li>
<li><a href="adopt_manual_batch_widget.html">Adopt the Create manual batch payments widget</a>
</li>
<li><a href="configure_navigation_notifications_widgets.html">Configure navigation for Notifications widgets</a>
</li>
<li><a href="how_to_use_theming.html">Use theming</a>
</li>
<li><a href="configure_account_numbers_displaying_in_products.html">Configure account numbers formatting for Products widgets</a>
</li>
<li><a href="synchronize_masking_behavior_in_products.html">Synchronize masking behavior with backed in Products widgets.</a>
</li>
</ul>
</li>
<li><a href="extend_and_build.html">Extend and build</a>
<ul class="sectlevel2">
<li><a href="extend_build_web.html">Extend and build web widgets</a>
<ul class="sectlevel3">
<li><a href="configure_batch_types.html">Add a custom batch type to the batch payment widgets</a>
</li>
<li><a href="configure_place_types.html">Customize the Find branches and ATMs widget</a>
</li>
<li><a href="field_mapping.html"><span class="toc-current">Field mapping</span></a>
</li>
<li><a href="country_injection.html">Country injection</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="reference.html">Reference</a>
<ul class="sectlevel2">
<li><a href="web_reference.html">Web widgets</a>
<ul class="sectlevel3">
<li><a href="contact_manager_pending_approvals_reference.html">Approve contact change requests</a>
</li>
<li><a href="cash_flow_common_lib_reference.html">Cash Flow Forecasting common library</a>
</li>
<li><a href="create_message_reference.html">Compose message by the customer</a>
</li>
<li><a href="configure_forecast_reference.html">Configure forecast</a>
</li>
<li><a href="connect_accounting_software_reference.html">Connect accounting software</a>
</li>
<li><a href="contact_create_reference.html">Create business contact</a>
</li>
<li><a href="create_fx_trade_order_reference.html">Create FX trade order</a>
</li>
<li><a href="manual_batch_reference.html">Create manual batch payments</a>
</li>
<li><a href="create_sweep_reference.html">Create sweep</a>
</li>
<li><a href="contact_edit_reference.html">Edit business contact</a>
</li>
<li><a href="places_reference.html">Find branches and ATMs</a>
</li>
<li><a href="ach_debit_reference.html">Initiate ACH debit</a>
</li>
<li><a href="omni_payment_reference.html">Initiate omni payment</a>
</li>
<li><a href="payment_wizard_reference.html">Initiate payment wizard</a>
</li>
<li><a href="login_reference.html">Log in user</a>
</li>
<li><a href="manage_ach_debit_reference.html">Manage ACH debit</a>
</li>
<li><a href="configure_business_approval_notification_settings_reference.html">Manage business approval notification preferences</a>
</li>
<li><a href="batch_upload_log_reference.html">Manage batch file uploads</a>
</li>
<li><a href="manage_batches_reference.html">Manage batch payments</a>
</li>
<li><a href="manage_forecast_settings_reference.html">Manage forecast settings</a>
</li>
<li><a href="contact_manager_business_reference.html">Manage business contacts</a>
</li>
<li><a href="card_management_details_reference.html">Manage cards</a>
</li>
<li><a href="contact_manager_my_requests_reference.html">Manage contact change requests</a>
</li>
<li><a href="contact_details_reference.html">Manage contact details</a>
</li>
<li><a href="manage_payables_reference.html">Manage payables</a>
</li>
<li><a href="manage_payments_reference.html">Manage payments</a>
</li>
<li><a href="manage_payment_templates_reference.html">Manage payment templates</a>
</li>
<li><a href="manage_sweeps_reference.html">Manage sweeps</a>
</li>
<li><a href="card_management_travel_notice_reference.html">Manage travel notice</a>
</li>
<li><a href="manage_user_security_reference.html">Manage user security</a>
</li>
<li><a href="notification_badge_reference.html">Notification badge</a>
</li>
<li><a href="request_stop_checks_reference.html">Request stop checks</a>
</li>
<li><a href="product_summary_account_picker_reference.html">Select business account</a>
</li>
<li><a href="select_context_reference.html">Select context</a>
</li>
<li><a href="upload_batch_reference.html">Upload batch payment</a>
</li>
<li><a href="user_context_menu_reference.html">View and change context</a>
</li>
<li><a href="view_download_business_account_statements_reference.html">View and download business account statements</a>
</li>
<li><a href="batch_payments_reference.html">View batch details</a>
</li>
<li><a href="product_summary_balance_history_reference.html">View business account balance history</a>
</li>
<li><a href="product_summary_account_details_reference.html">View business account details</a>
</li>
<li><a href="product_summary_accounts_overview_reference.html">View business account list</a>
</li>
<li><a href="card_management_overview_reference.html">View cards</a>
</li>
<li><a href="view_forecast_reference.html">View cash flow forecast</a>
</li>
<li><a href="contact_list_reference.html">View contact list</a>
</li>
<li><a href="messages_conversation_thread_reference.html">View conversation thread by the customer</a>
</li>
<li><a href="product_summary_favorite_accounts_reference.html">View favorite accounts</a>
</li>
<li><a href="view_fx_pair_details_reference.html">View FX pair details</a>
</li>
<li><a href="view_fx_rates_reference.html">View FX rates</a>
</li>
<li><a href="messages_conversations_list_reference.html">View messages by the customer</a>
</li>
<li><a href="view_receivables_reference.html">View receivables</a>
</li>
<li><a href="cash_flow_payment_request_details_reference.html">Cash flow payment request details</a>
</li>
<li><a href="view_sticky_popup_notifications_reference.html">View sticky and pop-up notifications</a>
</li>
<li><a href="stop_checks_list_reference.html">View stop check payment requests</a>
</li>
<li><a href="view_sweep_details_reference.html">View sweep details</a>
</li>
<li><a href="transactions_reference.html">View transactions table</a>
</li>
</ul>
</li>
<li><a href="bb_product_compatibility.html">Backbase product compatibility</a>
</li>
<li><a href="retirement.html">Backbase software lifecycle</a>
</li>
<li><a href="downloads_all.html">Downloads</a>
</li>
<li><a href="glossary.html">Glossary</a>
</li>
<li><a href="modendtbl.html">Module/Endpoint list</a>
</li>
<li><a href="payments_schematics_reference.html">Payments Schematics</a>
</li>
<li><a href="platform_support.html">Software requirements</a>
</li>
<li><a href="third_party_dependencies.html">Third-party dependencies</a>
</li>
<li><a href="troubleshoot_angular_10_upgrade.html">Troubleshooting Angular 10 upgrade</a>
</li>
</ul>
</li>
<li><a href="release_notes.html">Release notes</a>
<ul class="sectlevel2">
<li><a href="cb3_3_10_1.html">Business Banking Widget Collection v3.10.1</a>
</li>
<li><a href="cb3_3100.html">Business Banking Widget Collection v3.10.0</a>
</li>
<li><a href="cb3_395.html">Business Banking Widget Collection v3.9.5</a>
</li>
<li><a href="cb3_394.html">Business Banking Widget Collection v3.9.4</a>
</li>
<li><a href="cb3_393.html">Business Banking Widget Collection v3.9.3</a>
</li>
<li><a href="cb3_392.html">Business Banking Widget Collection v3.9.2</a>
</li>
<li><a href="cb3_391.html">Business Banking Widget Collection v3.9.1</a>
</li>
<li><a href="cb3_390.html">Business Banking Widget Collection v3.9.0</a>
</li>
<li><a href="cb3_381.html">Business Banking Widget Collection v3.8.1</a>
</li>
<li><a href="cb3_380.html">Business Banking Widget Collection v3.8.0</a>
</li>
<li><a href="cb3_371.html">Widget Collection Business Banking v3.7.1</a>
</li>
<li><a href="cb3_370.html">Widget Collection Business Banking v3.7.0</a>
</li>
<li><a href="cb3_362.html">Widget Collection Business Banking v3.6.2</a>
</li>
<li><a href="cb3_361.html">Widget Collection Business Banking v3.6.1</a>
</li>
<li><a href="cb3_360.html">Widget Collection Business Banking v3.6.0</a>
</li>
<li><a href="cb3_353.html">Widget Collection Business Banking v3.5.3</a>
</li>
<li><a href="cb3_352.html">Widget Collection Business Banking v3.5.2</a>
</li>
<li><a href="cb3_351.html">Widget Collection Business Banking v3.5.1</a>
</li>
<li><a href="bb_350.html">Widget Collection Business Banking v3.5.0</a>
</li>
<li><a href="bb_343.html">Widget Collection Business Banking v.3.4.3</a>
</li>
<li><a href="bb_342.html">Widget Collection Business Banking v.3.4.2</a>
</li>
<li><a href="bb_341.html">Widget Collection Business Banking v.3.4.1</a>
</li>
<li><a href="bb_340.html">Business Banking Widget Collection v.3.4.0</a>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<h1 id="field_mapping" class="sect0">Field mapping</h1>
          <div class="paragraph">
<p>This document outlines the process for mapping status and replacement status fields,
in order to configure which backend status maps to frontend logic.</p>
</div>
<h2 id="_how_to_map_status_fields" class="discrete">How to map status fields</h2>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Mapping of status and replacement status fields</strong></p>
<div class="paragraph">
<p>The <code>status</code> and <code>replacementStatus</code> fields are free-format fields in the spec.  For <code>lockStatus</code>,
the value can only be one of two enum values (<code>LOCKED</code> or <code>UNLOCKED</code>).  But for <code>status</code> and
<code>replacementStatus</code>, this means that clients implementing the Cards API can have any value for
them, based on the backend they are integrating with.</p>
</div>
<div class="paragraph">
<p>In order to implement logic based on status and replacement status, these fields are mapped to an
internal status, which can then be used inside the widget to display different states, etc.  The
following statuses are supported and they have the following default mapping:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Status</th>
<th class="tableblock halign-left valign-top">Mapped from <code>status</code> value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ACTIVE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(empty) or <code>Active</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INACTIVE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Inactive</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CANCELED</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Canceled</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EXPIRED</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Expired</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If the status value cannot be mapped, it is passed 1:1 to the internal model.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Replacement status</th>
<th class="tableblock halign-left valign-top">Mapped from <code>replacementStatus</code> value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NOT_UNDER_REPLACEMENT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(empty) or <code>NotUnderReplacement</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>UNDER_REPLACEMENT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ReplacementRequested</code> or <code>ReplacementInTransit</code> or <code>ReplacementUnderCancellation</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>REPLACED</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Replaced</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If the replacement status value cannot be mapped, it is passed 1:1 to the internal model.</p>
</div>
</li>
<li>
<p><strong>Configuring custom mapping</strong></p>
<div class="paragraph">
<p>The default mapping reflects the out-of-the-box behavior of the <code>cards-integration-mock-service</code>.
It is possible to customize this mapping by providing config values in the app.  InjectionTokens
for these values are <code>StatusMappingConfigToken</code> and <code>ReplacementStatusMappingConfigToken</code> and can
be imported from the widget modules.  You can find out <a href="http://wa3.backbase.com/foundation/latest/howto/make-a-configurable-service">here</a>
how this mechanic works.</p>
</div>
<div class="paragraph">
<p>For example, it can be done as follows:</p>
</div>
<div class="paragraph">
<p>Add the following to your <code>environment.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">// add to the `environment` object
customStatusMapping: {
  'Active': 'ACTIVE',
  'Inactive': 'INACTIVE',
  'Cancelled': 'CANCELED',
  'Expired': 'EXPIRED',
},
customReplacementStatusMapping: {
  'NotUnderReplacement': 'NOT_UNDER_REPLACEMENT',
  'ReplacementRequested': 'UNDER_REPLACEMENT',
  'ReplacementInTransit': 'UNDER_REPLACEMENT',
  'ReplacementUnderCancellation': 'UNDER_REPLACEMENT',
  'Replaced': 'REPLACED',
},</code></pre>
</div>
</div>
<div class="paragraph">
<p>Change these mappings to match what your backend returns for respectively the <code>status</code> and the
<code>replacementStatus</code> field.  In this example, you can see that the backend <code>ReplacementRequested</code>
payload is mapped to the frontend <code>UNDER_REPLACEMENT</code> status.</p>
</div>
<div class="paragraph">
<p>Add the following to your <code>app.module.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">// imports at the top of the file
import { StatusMappingConfigToken, ReplacementStatusMappingConfigToken } from '@backbase/cards-list-widget-ang';

// add to the `providers` array
providers: [
  { provide: StatusMappingConfigToken, useValue: environment.customStatusMapping },
  { provide: ReplacementStatusMappingConfigToken, useValue: environment.customReplacementStatusMapping },
],</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Mapping of replacement reason fields</strong></p>
<div class="paragraph">
<p>The <code>replacementReason</code> field in for the replacement POST request is also a free-format field in
the spec.  Just like <code>status</code>, it is possible to configure a mapping from internal reason (as used
in the views) to a backend-specific reason that is sent with the POST request.</p>
</div>
<div class="paragraph">
<p>The following replacement reasons are used and the default mapping is as follows:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Replacement reason</th>
<th class="tableblock halign-left valign-top">Mapped to <code>replacementReason</code> value in POST</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOST</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Lost</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STOLEN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Stolen</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DAMAGED</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Damaged</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If the replacement reason cannot be mapped, it is passed 1:1 with the POST request.</p>
</div>
</li>
<li>
<p><strong>Configuring custom mapping</strong></p>
<div class="paragraph">
<p>Use the same approach for <code>status</code> and <code>replacementStatus</code>, as described above.  The InjectionToken
to be used is <code>ReplacementReasonMappingConfigToken</code>.  As an example, this could be added to
your <code>environment.ts</code>:</p>
</div>
<div class="paragraph">
<p>Add the following to your <code>environment.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">// add to the `environment` object
customReplacementReasonMapping: {
  'LOST': 'Lost'
  'STOLEN': 'Stolen'
  'DAMAGED': 'Damaged'
},</code></pre>
</div>
</div>
<div class="paragraph">
<p>Change these mappings to match what your backend expects for the <code>replacementReason</code> field.  In
this example, you can see the frontend <code>LOST</code> reason is mapped to the backend <code>Lost</code> payload.</p>
</div>
<div class="paragraph">
<p>Add the following to your <code>app.module.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">// imports at the top of the file
import { ReplacementReasonMappingConfigToken } from '@backbase/cards-list-widget-ang';

// add to the `providers` array
providers: [
  { provide: ReplacementReasonMappingConfigToken, useValue: environment.customReplacementReasonMapping },
],</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</body>
</html>